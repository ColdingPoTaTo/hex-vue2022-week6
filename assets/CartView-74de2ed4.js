import{_ as x,o as d,c as l,a as _,d as t,F as p,f,g,t as r,h as C,v as b}from"./index-12cf90d8.js";const{VITE_APP_PATH:i,VITE_APP_URL:u}={VITE_APP_URL:"https://vue3-course-api.hexschool.io",VITE_APP_PATH:"hexpotato",BASE_URL:"/hex-vue2022-week6/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},m={data(){return{products:[],productId:"",cart:{},loadingItem:"",form:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{getCart(){this.$http.get(`${u}/v2/api/${i}/cart`).then(s=>{this.cart=s.data.data})},updateCart(s){const a={product_id:s.product.id,qty:s.qty};this.loadingItem=s.id,this.$http.put(`${u}/v2/api/${i}/cart/${s.id}`,{data:a}).then(c=>{this.getCart(),this.loadingItem=""})},deleteCart(s){this.loadingItem=s.id,this.$http.delete(`${u}/v2/api/${i}/cart/${s.id}`).then(a=>{this.getCart(),this.loadingItem=""})},deleteCarts(){this.$http.delete(`${u}/v2/api/${i}/carts`).then(s=>{this.getCart()})},onSubmit(){const s=`${u}/v2/api/${i}/order`,a=this.form;this.$http.post(s,{data:a}).then(c=>{alert(c.data.message),this.$refs.form.resetForm(),this.getCart()}).catch(c=>{alert(c.response.data.message)})}},mounted(){this.getCart()}},v={class:"text-end"},y={class:"table align-middle"},$=t("thead",null,[t("tr",null,[t("th"),t("th",null,"品名"),t("th",{style:{width:"150px"}},"數量/單位"),t("th",null,"單價")])],-1),I=["onClick"],k=["hidden","disabled"],P={key:0,class:"text-success"},V={class:"input-group input-group-sm"},E={class:"input-group mb-3"},A=["onUpdate:modelValue","onChange","disabled"],T=["value"],S={class:"input-group-text",id:"basic-addon2"},D={class:"text-end"},R={key:0,class:"text-success"},U=t("td",{colspan:"3",class:"text-end"},"總計",-1),q={class:"text-end"},w=t("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),B={class:"text-end text-success"};function L(s,a,c,F,o,h){return d(),l(p,null,[_(" 這是購物車頁面 "),t("div",v,[t("button",{class:"btn btn-outline-danger",type:"button",onClick:a[0]||(a[0]=(...e)=>h.deleteCarts&&h.deleteCarts(...e))},"清空購物車")]),t("table",y,[$,t("tbody",null,[o.cart.carts?(d(!0),l(p,{key:0},f(o.cart.carts,e=>(d(),l("tr",{key:e.id},[t("td",null,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:n=>h.deleteCart(e)},[t("i",{class:"fas fa-spinner fa-pulse",hidden:o.loadingItem!==e.id,disabled:o.loadingItem===e.id},null,8,k),_(" x ")],8,I)]),t("td",null,[_(r(e.product.title)+" ",1),e.coupon?(d(),l("div",P,"已套用優惠券")):g("",!0)]),t("td",null,[t("div",V,[t("div",E,[C(t("select",{"onUpdate:modelValue":n=>e.qty=n,class:"form-select",onChange:n=>h.updateCart(e),disabled:o.loadingItem===e.id},[(d(),l(p,null,f(20,n=>t("option",{key:`add${n}`,value:n},r(n),9,T)),64))],40,A),[[b,e.qty]]),t("span",S,r(e.product.unit),1)])])]),t("td",D,[e.coupon?(d(),l("small",R,"折扣價：")):g("",!0),_(" "+r(e.final_total),1)])]))),128)):g("",!0)]),t("tfoot",null,[t("tr",null,[U,t("td",q,r(o.cart.total),1)]),t("tr",null,[w,t("td",B,r(o.cart.final_total),1)])])])],64)}const H=x(m,[["render",L]]);export{H as default};
